//=============================================================================
// File    : DataChange.js
// Author  : Eric Woodruff  (Eric@EWoodruff.us)
// Updated : Fri 11/26/2004
var c=false;var d;function BP_funCheckForChanges(a){var f,g,h,i,j,k;var l,m,n,o,p;var q=document.forms[BP_strFormName];var r=q.elements.length;var s=(typeof(a)=="undefined");var t=document.getElementsByName("BP_bIsDirty")[0];if(s==true&&c==true)return;var u=(t.value=="true");f="";l=document.getElementById("__EVENTTARGET");if(l==null||typeof(l)=="undefined"||l.value==""){if(document.addEventListener){if(typeof(d)!="undefined")f=d.id;}else{if(typeof(document.activeElement)!="undefined"){l=document.activeElement;f=l.id;}}}else f=l.value;if(f==""&&l!=null&&typeof(l)!="undefined"){if(l.tagName=="A"&&l.href.indexOf("__doPostBack")!=-1)return;if(typeof(l.parentElement)!="undefined")f=l.parentElement.id;}if(f!=""){i=BP_arrBypassList.length;for(g=0;g<i;g++)if(f==BP_arrBypassList[g]){s=false;}else{j=f.length-BP_arrBypassList[g].length;if(j>=0)if(f.substr(j)==BP_arrBypassList[g]){s=false;}}}i=BP_arrSkipList.length;for(g=0;!u&&g<r;g++){l=q.elements[g];for(k=0;k<i;k++){if(l.id==BP_arrSkipList[k])break;j=l.id.length-BP_arrSkipList[k].length;if(j>=0)if(l.id.substr(j)==BP_arrSkipList[k])break;}if(k<i)continue;if(l.type=="text"||l.tagName=="TEXTAREA"){if(l.value!=l.defaultValue)u=true;}else if(l.type=="checkbox"||l.type=="radio"){if(l.checked!=l.defaultChecked)u=true;}else if(l.tagName=="SELECT"){m=l.options;h=m.length;o=p=0;for(k=0;k<h;k++){n=m[k];if(n.defaultSelected)o=k;if(n.selected)p=k;}if(o!=p)u=true;}}if(u){t.value="true";if(s){return BP_strDataLossMsg;c=true;window.setTimeout("BP_funClearIfCancelled()",1000);}}}function BP_funClearIfCancelled(){var l;c=false;l=document.getElementById("__EVENTTARGET");if(l!=null&&typeof(l)!="undefined")l.value="";}document.forms[BP_strFormName].BP_RealOnSubmit=document.forms[BP_strFormName].submit;function BP_OnSubmit(){BP_funCheckForChanges(true);try{document.forms[BP_strFormName].BP_RealOnSubmit();}catch(e){}}document.forms[BP_strFormName].submit=BP_OnSubmit;window.onbeforeunload=function CallCheck(b){if(typeof b=='undefined'){b=window.event;}if(b){var v=BP_funCheckForChanges();if(v!=null)b.returnValue=v;}}function onElementFocused(e){if(e&&e.target){d=e.target;}}if(document.addEventListener)document.addEventListener("focus",onElementFocused,true);